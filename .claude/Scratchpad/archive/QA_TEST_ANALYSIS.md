# QA Test Analysis Report

**Date:** 2025-12-28
**Agent:** QA_TESTER

---

## Executive Summary

Backend test suite: **~6,645 tests** collected. Critical issue: SQLite/PostgreSQL ARRAY type incompatibility causes 600+ errors.

---

## Test Run Summary

| Category | Passed | Failed | Errors |
|----------|--------|--------|--------|
| Service Tests | 271 | 9 | 159 |
| Unit Tests | 317 | 13 | 40 |
| Analytics Tests | 87 | 1 | 0 |
| Route Tests | 0 | 0 | 408 |

---

## Root Cause: SQLite/PostgreSQL Incompatibility

**Error:**
```
sqlalchemy.exc.CompileError: Compiler can't render element of type ARRAY
```

**Affected:** 607 tests (all using database fixtures)

**Fix Options:**
1. Run tests against PostgreSQL in Docker (recommended)
2. Create SQLite-compatible type variants

---

## Coverage Gaps

### Critical Services Without Tests

| Service | Priority |
|---------|----------|
| `auth_service.py` | CRITICAL |
| `constraint_service.py` | CRITICAL |
| `swap_validation.py` | CRITICAL |
| `scheduler.py` route | CRITICAL |
| `fatigue_risk.py` route | CRITICAL |

---

## Action Items

### Immediate
1. Fix SQLite ARRAY compatibility (4-8 hours)
2. Fix import errors in notification tests (1-2 hours)
3. Fix mock targets in certification tests (2-3 hours)

### Short Term
1. Add auth_service tests
2. Add constraint_service tests
3. Add swap_validation tests

---

## Test Command (with ignores)

```bash
docker-compose exec backend pytest \
  --ignore=tests/cqrs \
  --ignore=tests/frms \
  --ignore=tests/integration \
  --ignore=tests/security \
  --ignore=tests/telemetry \
  -v --tb=short
```

---

*Report generated by QA_TESTER agent*
